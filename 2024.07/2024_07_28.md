## Today I Learned (2024-07-28) ğŸ¤”
---
> ## ëª©ì°¨
- [Today I Learned (2024-07-28) ğŸ¤”](#today-i-learned-2024-07-28-)
- [ì˜¤ëŠ˜ ê³µë¶€í•œ ë‚´ìš© ğŸ§‘ğŸ»â€ğŸ’»](#ì˜¤ëŠ˜-ê³µë¶€í•œ-ë‚´ìš©-)
  - [1. Doit! ì‰¡ê²Œ ë°°ìš°ëŠ” íŒŒì´ì¬ ë°ì´í„° ë¶„ì„ (ë„ì„œ)](#1-doit-ì‰¡ê²Œ-ë°°ìš°ëŠ”-íŒŒì´ì¬-ë°ì´í„°-ë¶„ì„-ë„ì„œ)
    - [**ì§€ë„ ë°ì´í„° ì‹œê°í™” - ì‹œêµ°êµ¬ë³„ ì¸êµ¬ ë‹¨ê²Œ ë¶„í¬ë„ ë§Œë“¤ê¸°**](#ì§€ë„-ë°ì´í„°-ì‹œê°í™”---ì‹œêµ°êµ¬ë³„-ì¸êµ¬-ë‹¨ê²Œ-ë¶„í¬ë„-ë§Œë“¤ê¸°)
    - [1. ë°ì´í„° ì¤€ë¹„í•˜ê¸°](#1-ë°ì´í„°-ì¤€ë¹„í•˜ê¸°)
    - [2. ë°ì´í„° ì‚¬ìš©í•˜ê¸°](#2-ë°ì´í„°-ì‚¬ìš©í•˜ê¸°)
    - [3. ë‹¨ê³„ êµ¬ë¶„ë„ ë§Œë“¤ê¸°](#3-ë‹¨ê³„-êµ¬ë¶„ë„-ë§Œë“¤ê¸°)
- [](#)
- [ì–´ë ¤ì› ë˜ ë‚´ìš© ğŸ“š](#ì–´ë ¤ì› ë˜-ë‚´ìš©-)
- [ê¶ê¸ˆí•œ ë‚´ìš©ê³¼ ë¶€ì¡±í•œ ë‚´ìš© ğŸ™‹ğŸ»](#ê¶ê¸ˆí•œ-ë‚´ìš©ê³¼-ë¶€ì¡±í•œ-ë‚´ìš©-)
- [ëŠë‚€ ì  ğŸ’¡](#ëŠë‚€-ì -)
---

## ì˜¤ëŠ˜ ê³µë¶€í•œ ë‚´ìš© ğŸ§‘ğŸ»â€ğŸ’»
### 1. Doit! ì‰¡ê²Œ ë°°ìš°ëŠ” íŒŒì´ì¬ ë°ì´í„° ë¶„ì„ ([ë„ì„œ](https://m.yes24.com/Goods/Detail/108947478))
#### **ì§€ë„ ë°ì´í„° ì‹œê°í™” - ì‹œêµ°êµ¬ë³„ ì¸êµ¬ ë‹¨ê²Œ ë¶„í¬ë„ ë§Œë“¤ê¸°**
- **ë‹¨ê³„ êµ¬ë¶„ë„ë€?**
  - ì§€ì—­ë³„ í†µê³„ì¹˜ë¥¼ ìƒ‰ê¹” ì°¨ì´ë¡œ í‘œí˜„í•œ ì§€ë„
  - ë‹¨ê³„ êµ¬ë¶„ë„ë¥¼ ë§Œë“¤ë©´ ì¸êµ¬ë‚˜ ì†Œë“ ê°™ì€ í†µê³„ì¹˜ê°€ ì§€ì—­ë³„ë¡œ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆë‹¤.
  - ë‹¨ê³„ êµ¬ë¶„ë„ë¥¼ ë§Œë“¤ë ¤ë©´ ìœ„ë„, ê²½ë„ ì¢Œí‘œê°€ ìˆëŠ” ì§€ë„ ë°ì´í„°ê°€ í•„ìš”í•˜ë‹¤.
---
- **ë°ì´í„°**
  - `SIG.geojson` : ì‹œêµ°êµ¬ë³„ ê²½ê³„ ì¢Œí‘œ
  - `Population_SIG.csv` : ì‹œêµ°êµ¬ë³„ ì¸êµ¬ í†µê³„ ë°ì´í„°
  - [`KOSIS í†µê³„ì²­ ë°ì´í„°`](https://kosis.kr/statHtml/statHtml.do?orgId=101&tblId=DT_1B040A3)
      - `á„’á…¢á†¼á„Œá…¥á†¼á„€á…®á„‹á…§á†¨_á„‰á…µá„€á…®á†«á„€á…®_á„‡á…§á†¯_á„Œá…®á„†á…µá†«á„ƒá…³á†¼á„…á…©á†¨á„‰á…¦á„ƒá…¢á„‰á…®_20240728105926. csv`
      - `sig.json`
- **.geojson ì´ë€?**
  - ìœ„ì¹˜ ì •ë³´ë¥¼ JSON í¬ë§·ìœ¼ë¡œ ì €ì¥í•œ í‘œì¤€ ì§€ë¦¬ ì •ë³´ ë°ì´í„° í¬ë§·ì´ë‹¤.
  - ë”•ì…”ë„ˆë¦¬ ìë£Œ êµ¬ì¡°ë¡œ ë˜ì–´ ìˆë‹¤.
    - `SIG_CD` : ì§€ì—­ì„ ë‚˜íƒ€ë‚´ëŠ” í–‰ì • êµ¬ì—­ ì½”ë“œ
    - `geometry` : ì‹œêµ°êµ¬ì˜ ê²½ê³„ë¥¼ ë‚˜íƒ€ë‚¸ ìœ„ë„, ê²½ë„ ì¢Œí‘œ
---
#### 1. ë°ì´í„° ì¤€ë¹„í•˜ê¸°
- **ì‹œêµ°êµ¬ë³„ ê²½ê³„ ì§€ë„ ë°ì´í„°**
  - ì±…ì—ì„œ ì œê³µí•´ì£¼ëŠ” ë°ì´í„°ë³´ë‹¤ëŠ” ì œì¼ ìµœì‹  ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì—ˆê¸° ë•Œë¬¸ì— [`ì›¹ ê¸°ë°˜ ê³µê°„ì •ë³´ ì„œë¹„ìŠ¤ GEOSERVICE-WEB`](https://www.geoservice.co.kr/) ì—ì„œ ë°ì´í„°ë¥¼ ì–»ì–´ì™”ë‹¤.
  - í•˜ì§€ë§Œ, `.json` ì´ë‚˜ `.geojson` í™•ì¥ìê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ë³€í™˜ì´ í•„ìš”í–ˆë‹¤.
  - [`mapshaper`](https://mapshaper.org/) ì‚¬ì´íŠ¸ë¥¼ í†µí•´ì„œ ë³€í™˜ì„ í–ˆë‹¤.
      - [ë„¤ì´ë²„ ë¸”ë¡œê·¸|ì•„ë¦„ë‹¤ìš´ ì„¸ìƒ **Foliumì„ ì´ìš©í•œ ë°ì´í„° ì‹œê°í™”**](https://blog.naver.com/PostView.nhn?blogId=kcchang61&logNo=221350672356)
      - [[Python]ì „êµ­ ì¸êµ¬ í˜„í™© ì§€ë„ ì‹œê°í™”](https://mkjjo.github.io/python/2019/08/18/korea_population.html)

- ì‹œêµ°êµ¬ë³„ ì¸êµ¬ ë°ì´í„°
  - ì¸êµ¬ ë°ì´í„°ë„ ìµœì‹  ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— [`KOSIS`](https://kosis.kr/statHtml/statHtml.do?orgId=101&tblId=DT_1B040A3) ì—ì„œ 2024ë…„ 6ì›” ìë£Œë¥¼ ë°›ì•„ì„œ ì‚¬ìš©í–ˆë‹¤.
---
#### 2. ë°ì´í„° ì‚¬ìš©í•˜ê¸°
- ì‹œêµ°êµ¬ë³„ ê²½ê³„ ì§€ë„ ë°ì´í„°
  ```python
  import json

  geo = json.load(open("../data/SIG.json", encoding="utf-8"))
  ```
- ì‹œêµ°êµ¬ë³„ ì¸êµ¬ ë°ì´í„°
  ```python
  import pandas as pd

  # ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
  df = pd.read_csv("../data/í–‰ì •êµ¬ì—­_ì‹œêµ°êµ¬_ë³„_ì£¼ë¯¼ë“±ë¡ì„¸ëŒ€ìˆ˜_20240728105926.csv")
  ```
  - ì»¬ëŸ¼ëª… ë³€ê²½
    - `M202406 2024.06` â†’ `pop`
    
    ```python
    # ì»¬ëŸ¼ëª… ë³€ê²½ (M202406 2024.06 -> pop)
    df = df.rename(columns={"M202406 2024.06": "pop"})
    ```
    
- ì¸êµ¬ìˆ˜ê°€ 0ì´ í–‰ ì œê±°

```python
# ì¸êµ¬ìˆ˜ê°€ 0ì¸ ê³³ ì œê±°
df_filtered = df[df["pop"] != 0]
```

- ì§€ì—­ì½”ë“œì™€ ì§€ì—­ ë¶„ë¦¬ (code / region)

```python
# ì§€ì—­ì½”ë“œì™€ ì§€ì—­ ë¶„ë¦¬ (code / region)
df_filtered.loc[:, "code"] = df_filtered.loc[:, "A í–‰ì •êµ¬ì—­(ì‹œêµ°êµ¬)ë³„"].str.split(
    " ", expand=True
)[0]
df_filtered.loc[:, "region"] = df_filtered.loc[:, "A í–‰ì •êµ¬ì—­(ì‹œêµ°êµ¬)ë³„"].str.split(
    " ", expand=True
)[1]
```

- í•„ìš” ì—†ëŠ” ì»¬ëŸ¼ ì‚­ì œ ë° ì „êµ­ í–‰ ì‚­ì œ

```python
# ì»¬ëŸ¼ ì‚­ì œ
df_filtered.drop(columns=["A í–‰ì •êµ¬ì—­(ì‹œêµ°êµ¬)ë³„"])

# ì „êµ­ í–‰ ì‚­ì œ
df_filtered.drop(0, axis='index',inplace=True)
```

- ì»¬ëŸ¼ ìˆœì„œ ë³€ê²½

```python
# ì»¬ëŸ¼ ìˆœì„œ ë³€ê²½
df_filtered = df_filtered[["code", "region", "pop"]]
df_filtered
```

```python

code	region	pop
1	11	ì„œìš¸íŠ¹ë³„ì‹œ	4486014
2	11110	ì¢…ë¡œêµ¬	72394
3	11140	ì¤‘êµ¬	65273
4	11170	ìš©ì‚°êµ¬	104187
5	11200	ì„±ë™êµ¬	133233
...	...	...	...
288	48880	ê±°ì°½êµ°	31219
289	48890	í•©ì²œêµ°	23895
290	50	ì œì£¼íŠ¹ë³„ìì¹˜ë„	314321
291	50110	ì œì£¼ì‹œ	225423
292	50130	ì„œê·€í¬ì‹œ	88898
```

---

#### 3. ë‹¨ê³„ êµ¬ë¶„ë„ ë§Œë“¤ê¸°

- folium ì„¤ì¹˜
  - folium : íŒŒì´ì¬ì„ ìœ„í•œ ì§€ë„ ì‹œê°í™” ë¼ì´ë¸ŒëŸ¬ë¦¬

- **ê¸°ë³¸ ë§µ**

```python
import folium

folium.Map(location=[35.97, 127.7], zoom_start=8)  # ì§€ë„ ì¤‘ì‹¬ ì¢Œí‘œ  # í™•ëŒ€ ë‹¨ê³„
```

![alt text](https://github.com/online5880/TIL/blob/main/Images/2024_07_28/folium_01.png?raw=true)

- ì§€ë„ ì¢…ë¥˜ ë³€ê²½

```python
map_sig = folium.Map(
    location=[35.95, 127.1],  # ì§€ë„ ì¤‘ì‹¬ ì¢Œí‘œ
    zoom_start=8,  # í™•ëŒ€ ë‹¨ê³„
    tiles="cartodbpositron",  # ì§€ë„ ì¢…ë¥˜
)
map_sig
```

![alt text](https://github.com/online5880/TIL/blob/main/Images/2024_07_28/folium_02.png?raw=true)

- **êµ¬ë¶„ë„ ë§Œë“¤ê¸°**

```python
# folium.Choropleth()
# geo_data   : ì§€ë„ ë°ì´í„°
# data       : ìƒ‰ê¹”ë¡œ í‘œí˜„í•  í†µê³„ ë°ì´í„°
# columns    : í†µê³„ ë°ì´í„°ì˜ í–‰ì • êµ¬ì—­ ì½”ë“œ ë³€ìˆ˜, ìƒ‰ê¹”ë¡œ í‘œí˜„í•  ë³€ìˆ˜
# key_on     : ì§€ë„ ë°ì´í„°ì˜ í–‰ì • êµ¬ì—­ ì½”ë“œ

folium.Choropleth(
    geo_data=geo,
    data=df_filtered,
    columns=("code", "pop"),
    key_on="feature.properties.SIG_CD",
).add_to(map_sig)

map_sig
```

![alt text](https://github.com/online5880/TIL/blob/main/Images/2024_07_28/folium_03.png?raw=true)

- ê³„ê¸‰ êµ¬ê°„ ì •í•˜ê¸°
    - `quantile()` ë¥¼ ì´ìš©í•´ ë¶„ìœ„ìˆ˜ë¥¼ êµ¬í•´ì„œ ì§€ì—­ ì¸êµ¬ìˆ˜ì— ë”°ë¥¸ ìƒ‰ê¹” êµ¬ë¶„ì„ í•´ì¤€ë‹¤.

```python
bins = list(df_filtered['pop'].quantile([0,0.2,0.4,0.6,0.8,1]))

folium.Choropleth(                     
    geo_data=geo,                       # ì§€ë„ ë°ì´í„°
    data=df_filtered,                   # í†µê³„ ë°ì´í„°
    columns=('code','pop'),             # df_filtered ì˜ í–‰ì • êµ¬ì—­ ì½”ë“œ, ì¸êµ¬
    key_on='feature.properties.SIG_CD', # geo í–‰ì • êµ¬ì—­ ì½”ë“œ
    fill_color='YlGn',                  # ì»¬ëŸ¬ë§µ
    fill_opacity=0.7,                   # íˆ¬ëª…ë„
    line_opacity=0.5,                   # ê²½ê³„ì„  íˆ¬ëª…ë„
    bins = bins,                        # ê³„ê¸‰ êµ¬ê°„ ê¸°ì¤€ê°’
    legend_name='ì¸êµ¬ìˆ˜'                  # ë²”ë¡€
).add_to(map_sig)

map_sig
```

![alt text](https://github.com/online5880/TIL/blob/main/Images/2024_07_28/folium_04.png?raw=true)
---
## ì–´ë ¤ì› ë˜ ë‚´ìš© ğŸ“š
- ë°ì´í„°ë¥¼ ì§ì ‘ ì°¾ê³  ì²˜ë¦¬í•˜ëŠ” ê³¼ì •
---
## ê¶ê¸ˆí•œ ë‚´ìš©ê³¼ ë¶€ì¡±í•œ ë‚´ìš© ğŸ™‹ğŸ»
- ë°ì´í„°ë“¤ì˜ êµ¬ì¡°?
---
## ëŠë‚€ ì  ğŸ’¡
- kdt ì—ì„œ ë°°ì› ë˜ folium ì„ ë‹¤ì‹œ ì¨ë³¼ ìˆ˜ ìˆëŠ” ê¸°íšŒì—¬ì„œ ì¢‹ì•˜ë‹¤.



